var _sentryDebugIds,_sentryDebugIdIdentifier;void 0===_sentryDebugIds&&(_sentryDebugIds={});try{var stack=(new Error).stack;stack&&(_sentryDebugIds[stack]="e01984b3-407c-41b9-ac64-031c4d9daa28",_sentryDebugIdIdentifier="sentry-dbid-e01984b3-407c-41b9-ac64-031c4d9daa28")}catch(e){}
var SENTRY_RELEASE;SENTRY_RELEASE={name: "Black Pill", version: "1.0.0"};
__d(function(g,r,_i,a,m,_e,d){"use strict";async function e(e){try{const o=await fetch(e,{mode:'cors',credentials:'omit'});if(!o.ok)throw new Error(`HTTP ${o.status}: ${o.statusText}`);const t=await o.blob(),n=URL.createObjectURL(t);return new Promise((o,t)=>{const i=new Image;i.onload=()=>{o(i)},i.onerror=()=>{URL.revokeObjectURL(n),t(new Error(`Failed to decode image from: ${e}`))},i.src=n})}catch(o){throw console.error(`Fetch error for ${e}:`,o),new Error(`Failed to load image: ${e}`)}}function o(e){return new Promise((o,t)=>{const n=new Image;n.crossOrigin='anonymous',n.onload=()=>o(n),n.onerror=()=>t(new Error(`Failed to load image: ${e}`)),n.src=e})}async function t(t){try{return await e(t)}catch(e){return console.warn('Fetch method failed, trying direct load:',e),await o(t)}}async function n(e,o){try{const t=await fetch(e,{mode:'cors',credentials:'omit'});if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const n=await t.arrayBuffer();return await o.decodeAudioData(n)}catch(o){throw console.error('Error loading audio:',o),new Error(`Failed to load audio: ${e}`)}}Object.defineProperty(_e,'__esModule',{value:!0}),_e.generateVideoFromFramesWeb=async function(e,o,i={}){if(e.length<2)throw new Error('At least 2 frames required to generate video');if('undefined'==typeof MediaRecorder)throw new Error('MediaRecorder API not supported in this browser');console.log('Loading images for web video generation...');const c=[],s=[];for(let o=0;o<e.length;o++){console.log(`Loading frame ${o+1}/${e.length}`);try{const n=await t(e[o]);c.push(n),n.src.startsWith('blob:')&&s.push(n.src)}catch(e){throw console.error(`Failed to load frame ${o}:`,e),s.forEach(e=>URL.revokeObjectURL(e)),new Error(`Failed to load frame ${o+1}`)}}const l=c[0].naturalWidth||720,u=c[0].naturalHeight||720,f=document.createElement('canvas');f.width=l,f.height=u;const w=f.getContext('2d');if(!w)throw s.forEach(e=>URL.revokeObjectURL(e)),new Error('Failed to get canvas context');const h=Math.max(1,Math.round(c.length/o)),p=1e3/h;console.log(`Generating video: ${l}x${u} @ ${h}fps, ${o}s duration`);let b=null,y=null,v=null;if(i.musicUrl)try{console.log('Loading background music...'),b=new AudioContext;const e=await n(i.musicUrl,b);y=b.createBufferSource(),y.buffer=e,y.loop=!0;const o=b.createGain();o.gain.value=i.musicVolume??.5,v=b.createMediaStreamDestination(),y.connect(o),o.connect(v),console.log('Background music loaded successfully')}catch(e){console.warn('Failed to load background music, continuing without audio:',e),b=null,y=null,v=null}const R=f.captureStream(h);let E;if(v){const e=v.stream.getAudioTracks()[0],o=R.getVideoTracks()[0];E=new MediaStream([o,e]),console.log('Combined video and audio streams')}else E=R;let T='video/webm;codecs=vp9,opus';MediaRecorder.isTypeSupported(T)||(T='video/webm;codecs=vp8,opus',MediaRecorder.isTypeSupported(T)||(T='video/webm;codecs=vp9',MediaRecorder.isTypeSupported(T)||(T='video/webm')));console.log(`Using codec: ${T}`);const $=new MediaRecorder(E,{mimeType:T,videoBitsPerSecond:25e5,audioBitsPerSecond:128e3}),L=[];return new Promise((e,o)=>{$.ondataavailable=e=>{e.data.size>0&&L.push(e.data)},$.onstop=()=>{console.log('Recording complete, assembling video...'),s.forEach(e=>URL.revokeObjectURL(e)),y&&y.stop(),b&&b.close();const o=new Blob(L,{type:'video/webm'});console.log(`Video generated: ${(o.size/1024/1024).toFixed(2)} MB`),e(o)},$.onerror=e=>{console.error('MediaRecorder error:',e),s.forEach(e=>URL.revokeObjectURL(e)),y&&y.stop(),b&&b.close(),o(new Error('Video recording failed'))},y&&y.start(0),$.start(),console.log('Recording started...');let t=0;const n=()=>{if(t<c.length){w.fillStyle='#000000',w.fillRect(0,0,l,u);const e=c[t],o=Math.min(l/e.naturalWidth,u/e.naturalHeight),i=e.naturalWidth*o,s=e.naturalHeight*o,f=(l-i)/2,h=(u-s)/2;w.drawImage(e,f,h,i,s),t++,setTimeout(n,p)}else setTimeout(()=>{$.stop(),E.getTracks().forEach(e=>e.stop())},100)};n()})},_e.downloadBlobAsFileWeb=async function(e,o){const t=new FileReader;return new Promise((n,i)=>{t.onloadend=()=>{try{const e=t.result,i=document.createElement('a');i.href=e,i.download=o,i.setAttribute('download',o),i.style.cssText='position:absolute;left:-9999px;top:-9999px;opacity:0;',document.body.appendChild(i),i.offsetHeight,i.click(),setTimeout(()=>{i.parentNode&&document.body.removeChild(i),n()},1e3)}catch(e){i(e)}},t.onerror=()=>i(new Error('Failed to read blob')),t.readAsDataURL(e)})},_e.isWebVideoGenerationSupported=function(){return'undefined'!=typeof document&&'undefined'!=typeof MediaRecorder&&'undefined'!=typeof HTMLCanvasElement&&'function'==typeof HTMLCanvasElement.prototype.captureStream}},3408,[]);